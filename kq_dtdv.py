import streamlit as st
import pandas as pd
import io
import re
import numpy as np
import csv

# ⚡ Chỉ gọi set_page_config một lần ở đầu
st.set_page_config(page_title="Báo cáo Doanh thu Dịch vụ", layout="wide")

# === CSS mở rộng cho layout rộng ===
st.markdown(
    """
    <style>
        .main {
            max-width: 95vw;
            padding-left: 2rem;
            padding-right: 2rem;
        }
        table {
            width: 100% !important;
        }
    </style>
    """,
    unsafe_allow_html=True
)

import streamlit as st

def st_title_with_logo(title_text, logo_base64, logo_height=40):
    """
    Hiển thị tiêu đề với logo Base64 bên trái.
    """
    st.markdown(
        f"""
        <h1 style="display: flex; align-items: center;">
            <img src="{logo_base64}" style="height:{logo_height}px; margin-right:10px;">
            {title_text}
        </h1>
        """,
        unsafe_allow_html=True
    )

# --- Base64 logo của bạn ---
logo_base64 = "data:image/png;base64,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"

# --- Gọi hàm ---
st_title_with_logo("Báo cáo tổng hợp số liệu dịch vụ", logo_base64)


# --- Khu vực import dữ liệu ---
st.markdown("### 🗂️ Nhập dữ liệu (HCR, HPMJC, HPMOTC, MIS, Receive, BPGRPM/CP)")
uploaded_files = st.file_uploader(
    "Kéo thả hoặc chọn nhiều file cùng lúc (CSV hoặc Excel)",
    accept_multiple_files=True,
    type=["csv", "xls", "xlsx"]
)

dataframes = {}

# === Hàm đọc file CSV/Excel tự động nhận encoding ===
def read_file(uploaded_file):
    name = uploaded_file.name.lower()
    if name.endswith((".xls", ".xlsx")):
        try:
            uploaded_file.seek(0)
            # nếu file excel có nhiều sheet, return ExcelFile object to handle sheets later
            try:
                xls = pd.ExcelFile(uploaded_file)
                # nếu chỉ 1 sheet thì parse to df, nếu nhiều sheet thì return dict of sheets
                if len(xls.sheet_names) == 1:
                    return xls.parse(xls.sheet_names[0])
                else:
                    # parse all sheets into dict
                    return {s: xls.parse(s) for s in xls.sheet_names}
            except Exception:
                uploaded_file.seek(0)
                return pd.read_excel(uploaded_file)
        except Exception as e:
            raise Exception(f"Lỗi đọc Excel: {e}")

    if not name.endswith(".csv"):
        raise Exception("Định dạng file không được hỗ trợ!")

    try:
        uploaded_file.seek(0)
        raw = uploaded_file.read()
    except Exception as e:
        raise Exception(f"Không thể đọc bytes từ file: {e}")

    encodings_to_try = [
        "utf-8-sig", "utf-8",
        "cp1258", "cp1252", "latin1",
        "iso-8859-1", "utf-16", "utf-16-le", "utf-16-be",
        "cp936"
    ]

    def detect_delimiter(text):
        candidates = ["\t", ";", ",", "|"]
        counts = {c: text.count(c) for c in candidates}
        best = max(counts, key=counts.get)
        if counts[best] > 0:
            return best
        try:
            dialect = csv.Sniffer().sniff(text, delimiters=candidates)
            return dialect.delimiter
        except Exception:
            return None

    last_err = None
    for enc in encodings_to_try:
        try:
            text = raw.decode(enc)
        except Exception as e:
            last_err = e
            continue

        sample = "\n".join(text.splitlines()[:20])
        sep = detect_delimiter(sample)

        try:
            if sep:
                df_try = pd.read_csv(io.StringIO(text), sep=sep, engine="python")
            else:
                df_try = pd.read_csv(io.StringIO(text), sep=None, engine="python")
            return df_try
        except Exception as e:
            last_err = e
            continue

    raise Exception(f"Không đọc được CSV với các kiểu mã hóa & delimiter thông dụng! (last error: {last_err})")


# Helper: tìm cột linh hoạt
def find_col(df, candidates):
    # candidates: list of possible names (Vietnamese/English variants)
    cols_map = {c.strip().lower(): c for c in df.columns}
    for cand in candidates:
        key = cand.strip().lower()
        if key in cols_map:
            return cols_map[key]
    # try contains
    for cand in candidates:
        for c in df.columns:
            if cand.strip().lower() in c.strip().lower():
                return c
    return None

# === Hàm xử lý tiền tệ ===
def parse_amount(value):
    if pd.isna(value):
        return 0.0
    s = str(value).replace("\xa0", "").replace("₫", "").replace("VND", "").replace("vnd", "")
    # giữ dấu thập phân? nhưng chúng ta chỉ cần lấy số nguyên (đồng)
    s = s.replace(",", "").strip()
    # remove any non-digit
    digits = re.sub(r"[^\d\-\.]", "", s)
    try:
        return float(digits) if digits not in ("", "-", ".") else 0.0
    except:
        return 0.0

# === Định nghĩa tiền công KTĐK ===
ktdk_cost = {
    "PI Service 01": 22500,
    "PI Service 02": 30000,
    "PI Service 03": 45000,
    "PI Service 04": 67500,
    "PI Service 05": 67500,
    "PI Service 06": 67500
}

# --- Đọc tất cả file và phân loại ---
if uploaded_files:
    success_count = 0
    for f in uploaded_files:
        name = f.name.lower()
        try:
            parsed = read_file(f)
            if parsed is not None:
                if "hcr" in name:
                    dataframes["HCR"] = parsed
                elif "hpmjc" in name:
                    dataframes["HPMJC"] = parsed
                elif "hpmotc" in name:
                    dataframes["HPMOTC"] = parsed
                elif "mis" in name:
                    dataframes["MIS"] = parsed
                elif "receive" in name:
                    dataframes["Receive"] = parsed
                elif "bpgrpm" in name:
                    # parsed can be a dict of sheets or a dataframe
                    if isinstance(parsed, dict):
                        # map sheet names ignoring case
                        mapped = {}
                        for sname, df in parsed.items():
                            if sname.strip().lower() == "bpgrpm":
                                mapped["BPGRPM"] = df
                            elif sname.strip().lower() == "cp":
                                mapped["CP"] = df
                            else:
                                # try assign by order if ambiguous
                                if "BPGRPM" not in mapped:
                                    mapped["BPGRPM"] = df
                                elif "CP" not in mapped:
                                    mapped["CP"] = df
                        # if only one sheet present, we still attach under BPGRPM
                        dataframes["BPGRPM"] = mapped
                    else:
                        # single sheet -> try name to decide
                        dataframes["BPGRPM"] = {"BPGRPM": parsed}
                elif "cp" in name and "bpgrpm" not in name:
                    # separate CP file
                    dataframes["CP"] = parsed
                else:
                    # nếu không phân loại rõ, lưu tạm theo tên file
                    key = re.sub(r'[^0-9a-zA-Z]', '_', f.name)
                    dataframes[key] = parsed
                success_count += 1
        except Exception as e:
            st.error(f"❌ Lỗi đọc file {f.name}: {e}")

    if success_count > 0:
        st.success(f"✅ Đã import thành công {success_count} file dữ liệu!")

def tinh_phu_tung_hao_mon(dataframes, tong_xe):
    import time
    import pandas as pd
    start_time = time.time()

    log_messages = []
    log_messages.append("🚀 Bắt đầu tính phụ tùng hao mòn...")

    # --- chuẩn bị các DataFrame đầu vào ---
    df_bp = None
    df_cp = None
    if "BPGRPM" in dataframes:
        bp_obj = dataframes["BPGRPM"]
        if isinstance(bp_obj, dict):
            mapped = {k.strip().lower(): v for k, v in bp_obj.items()}
            df_bp = mapped.get("bpgrpm", next(iter(mapped.values())))
        elif isinstance(bp_obj, pd.DataFrame):
            df_bp = bp_obj.copy()
    if "CP" in dataframes:
        cp_obj = dataframes["CP"]
        if isinstance(cp_obj, dict):
            mapped = {k.strip().lower(): v for k, v in cp_obj.items()}
            df_cp = mapped.get("cp", next(iter(mapped.values())))
        elif isinstance(cp_obj, pd.DataFrame):
            df_cp = cp_obj.copy()

    if df_bp is not None:
        df_bp.columns = [c.strip() for c in df_bp.columns]
    if df_cp is not None:
        df_cp.columns = [c.strip() for c in df_cp.columns]

    log_messages.append(f"📥 BPGRPM rows: {len(df_bp) if df_bp is not None else 'Không có'}; CP rows: {len(df_cp) if df_cp is not None else 'Không có'}")

    # --- build maps ---
    map_code_to_type = {}
    if df_cp is not None:
        c_code = find_col(df_cp, ["Mã Phụ tùng", "Mã phụ tùng", "Part#", "Part Number", "Part"])
        c_type = find_col(df_cp, ["Loại phụ tùng", "Loại", "Type", "Loại phụ"])
        if c_code and c_type:
            df_cp_temp = df_cp[[c_code, c_type]].dropna(subset=[c_code])
            df_cp_temp[c_code] = df_cp_temp[c_code].astype(str).str.strip()
            map_code_to_type = pd.Series(df_cp_temp[c_type].astype(str).values, index=df_cp_temp[c_code]).to_dict()
            log_messages.append(f"🔗 map_code_to_type: {len(map_code_to_type)} mã")

    map_code_to_dnp = {}
    b_code = None
    if df_bp is not None:
        b_code = find_col(df_bp, ["Mã phụ tùng", "Mã Phụ tùng", "Part#", "Part Number"])
        b_dnp = find_col(df_bp, ["DNP", "DNP ", "DNP/Unit Price", "Giá nhập", "DNP/Unit"])
        if b_code and b_dnp:
            df_bp_temp = df_bp[[b_code, b_dnp]].dropna(subset=[b_code])
            df_bp_temp[b_code] = df_bp_temp[b_code].astype(str).str.strip()
            df_bp_temp["_dnp_num"] = df_bp_temp[b_dnp].apply(parse_amount)
            map_code_to_dnp = pd.Series(df_bp_temp["_dnp_num"].values, index=df_bp_temp[b_code]).to_dict()
            log_messages.append(f"🔗 map_code_to_dnp: {len(map_code_to_dnp)} mã")

    # --- Nhóm phụ tùng ---
    groups = ["Dây đai", "Lọc gió", "Lốp", "Má phanh", "Xích tải"]

    # --- Khởi tạo accumulator ---
    accum = {g: {"JC_qty": 0.0, "OTC_qty": 0.0, "JC_dnp": 0.0, "OTC_dnp": 0.0,
                 "Receive_qty": 0.0, "Receive_dnp": 0.0,
                 "Stock_qty": 0.0, "Stock_dnp": 0.0}
             for g in groups}

    # --- Tính JC ---
    df_jc = dataframes.get("HPMJC")
    if df_jc is not None:
        df_jc = df_jc.copy()
        df_jc.columns = [c.strip() for c in df_jc.columns]
        status_col = find_col(df_jc, ["Trạng thái", "Status", "Trạng thái đặt hàng"])
        code_col = find_col(df_jc, ["Mã phụ tùng", "Part#", "Part Number"])
        qty_col = find_col(df_jc, ["Số lượng xác nhận", "Số lượng", "Confirmed Quantity"])
        price_col = find_col(df_jc, ["Giá nhập", "Đơn giá", "Cost Price"])
        df_jc_closed = df_jc[df_jc[status_col].astype(str).str.upper() == "CLOSED"].copy()
        df_jc_closed[qty_col] = pd.to_numeric(df_jc_closed[qty_col], errors="coerce").fillna(0)
        df_jc_closed[price_col] = df_jc_closed[price_col].apply(parse_amount).fillna(0)
        df_jc_closed["Nhóm"] = df_jc_closed[code_col].astype(str).map(map_code_to_type).fillna("")
        df_jc_closed["DNP"] = df_jc_closed[qty_col] * df_jc_closed[price_col]

        # Cấu hình quy tắc SL và DNP
        group_rules = {
            "Dây đai": {"related": ["Dây đai"], "qty_factors": {"Dây đai": 1}},
            "Lọc gió": {"related": ["Lọc gió"], "qty_factors": {"Lọc gió": 1}},
            "Lốp": {"related": ["Lốp"], "qty_factors": {"Lốp": 1}},
            "Má phanh": {"related": ["Má phanh", "Má phanh x2", "Má phanh + Xích tải x3"],
                         "qty_factors": {"Má phanh": 1, "Má phanh x2": 2, "Má phanh + Xích tải x3": 1}},
            "Xích tải": {"related": ["Xích tải", "Má phanh + Xích tải x3"],
                         "qty_factors": {"Xích tải": 1, "Má phanh + Xích tải x3": 3}},
        }

        for g in groups:
            rule = group_rules[g]
            # SL
            accum[g]["JC_qty"] = sum(df_jc_closed.loc[df_jc_closed["Nhóm"] == sg, qty_col].sum() * f for sg, f in rule["qty_factors"].items())
            # DNP
            accum[g]["JC_dnp"] = df_jc_closed.loc[df_jc_closed["Nhóm"].isin(rule["related"]), "DNP"].sum()

    # --- Tính OTC ---
    df_otc = dataframes.get("HPMOTC")
    if df_otc is not None:
        df_otc = df_otc.copy()
        df_otc.columns = [c.strip() for c in df_otc.columns]
        status_col = find_col(df_otc, ["Trạng thái", "Trạng thái đặt hàng", "Status"])
        code_col = find_col(df_otc, ["Mã phụ tùng", "Part#", "Part Number"])
        qty_col = find_col(df_otc, ["Số lượng đặt hàng", "Số lượng", "Order Quantity"])
        price_col = find_col(df_otc, ["Giá nhập", "Đơn giá", "Cost Price"])
        df_otc_closed = df_otc[df_otc[status_col].astype(str).str.upper() == "CLOSED"].copy()
        df_otc_closed[qty_col] = pd.to_numeric(df_otc_closed[qty_col], errors="coerce").fillna(0)
        df_otc_closed[price_col] = df_otc_closed[price_col].apply(parse_amount).fillna(0)
        df_otc_closed["Nhóm"] = df_otc_closed[code_col].astype(str).map(map_code_to_type).fillna("")
        df_otc_closed["DNP"] = df_otc_closed[qty_col] * df_otc_closed[price_col]

        group_rules = {
            "Dây đai": {"related": ["Dây đai"], "qty_factors": {"Dây đai": 1}},
            "Lọc gió": {"related": ["Lọc gió"], "qty_factors": {"Lọc gió": 1}},
            "Lốp": {"related": ["Lốp"], "qty_factors": {"Lốp": 1}},
            "Má phanh": {"related": ["Má phanh", "Má phanh x2", "Má phanh + Xích tải x3"],
                         "qty_factors": {"Má phanh": 1, "Má phanh x2": 2, "Má phanh + Xích tải x3": 1}},
            "Xích tải": {"related": ["Xích tải", "Má phanh + Xích tải x3"],
                         "qty_factors": {"Xích tải": 1, "Má phanh + Xích tải x3": 3}},
        }

        for g in groups:
            rule = group_rules[g]
            accum[g]["OTC_qty"] = sum(df_otc_closed.loc[df_otc_closed["Nhóm"] == sg, qty_col].sum() * f for sg, f in rule["qty_factors"].items())
            accum[g]["OTC_dnp"] = df_otc_closed.loc[df_otc_closed["Nhóm"].isin(rule["related"]), "DNP"].sum()

    # --- Tính Nhận SL & Nhận (DNP) từ Receive ---
    df_receive = dataframes.get("Receive")
    if df_receive is not None:
        df_receive = df_receive.copy()
        df_receive.columns = [c.strip() for c in df_receive.columns]

        # tìm cột phù hợp trong Receive
        part_col_rcv = find_col(df_receive, ["Part#", "Part Number", "Mã phụ tùng", "Part"])
        qty_col_rcv = find_col(df_receive, ["Qty", "Quantity", "Số lượng"])
        price_col_rcv = find_col(df_receive, ["Unit Price", "Price", "Giá nhập", "DNP/Unit", "DNP/Unit Price"])
        status_col_rcv = find_col(df_receive, ["MRN Status", "Status", "Trạng thái"])

        # Lọc MRN Status == Closed (nếu có cột)
        if status_col_rcv:
            df_receive_closed = df_receive[df_receive[status_col_rcv].astype(str).str.strip().str.lower() == "closed"].copy()
        else:
            # Nếu không có cột MRN Status thì lấy hết (hoặc bạn có thể quyết định bỏ qua)
            df_receive_closed = df_receive.copy()

        # Chuẩn hoá Part# và ánh xạ sang Nhóm bằng map_code_to_type
        if part_col_rcv:
            df_receive_closed["Part#_norm"] = df_receive_closed[part_col_rcv].astype(str).str.strip()
            df_receive_closed["Nhóm"] = df_receive_closed["Part#_norm"].map(map_code_to_type).fillna("")
        else:
            df_receive_closed["Nhóm"] = ""

        # Tính DNP (Qty * Unit Price) nếu có cột tương ứng
        if qty_col_rcv:
            df_receive_closed["Qty_num"] = pd.to_numeric(df_receive_closed[qty_col_rcv], errors="coerce").fillna(0)
        else:
            df_receive_closed["Qty_num"] = 0

        if price_col_rcv:
            # Dùng parse_amount nếu giá có dạng chuỗi
            try:
                df_receive_closed["UnitPrice_num"] = df_receive_closed[price_col_rcv].apply(parse_amount).fillna(0)
            except Exception:
                df_receive_closed["UnitPrice_num"] = pd.to_numeric(df_receive_closed[price_col_rcv], errors="coerce").fillna(0)
        else:
            df_receive_closed["UnitPrice_num"] = 0

        df_receive_closed["DNP"] = df_receive_closed["Qty_num"] * df_receive_closed["UnitPrice_num"]

        log_messages.append(f"📥 Receive rows (closed): {len(df_receive_closed)}")

        # Sử dụng cùng group_rules như JC/OTC (nếu group_rules không tồn tại, tái tạo)
        try:
            _ = group_rules  # kiểm tra tồn tại
        except NameError:
            group_rules = {
                "Dây đai": {"related": ["Dây đai"], "qty_factors": {"Dây đai": 1}},
                "Lọc gió": {"related": ["Lọc gió"], "qty_factors": {"Lọc gió": 1}},
                "Lốp": {"related": ["Lốp"], "qty_factors": {"Lốp": 1}},
                "Má phanh": {
                    "related": ["Má phanh", "Má phanh x2", "Má phanh + Xích tải x3"],
                    "qty_factors": {"Má phanh": 1, "Má phanh x2": 2, "Má phanh + Xích tải x3": 1}
                },
                "Xích tải": {
                    "related": ["Xích tải", "Má phanh + Xích tải x3"],
                    "qty_factors": {"Xích tải": 1, "Má phanh + Xích tải x3": 3}
                },
            }

        # --- Tính Receive (số lượng & DNP) ---
        for g in groups:
            if g not in group_rules:
                continue
            rule = group_rules[g]

            # SL: nhân hệ số như JC/OTC
            total_qty = 0
            for subgroup, factor in rule["qty_factors"].items():
                total_qty += df_receive_closed.loc[df_receive_closed["Nhóm"] == subgroup, "Qty_num"].sum() * factor
            accum[g]["Receive_qty"] = total_qty

            # DNP: tổng DNP của tất cả related (không nhân hệ số)
            total_dnp = df_receive_closed.loc[df_receive_closed["Nhóm"].isin(rule["related"]), "DNP"].sum()
            accum[g]["Receive_dnp"] = total_dnp




    # --- MIS: tính Tồn SL & Tồn DNP ---
    df_mis = dataframes.get("MIS")
    if df_mis is not None and df_bp is not None:
        df_mis = df_mis.copy()
        df_mis.columns = [c.strip() for c in df_mis.columns]

        qty_col = find_col(df_mis, ["Quantity", "Số lượng", "Qty"])
        part_col = find_col(df_mis, ["Part Number", "Part#", "Mã phụ tùng"])

        if qty_col and part_col:
            df_mis[qty_col] = pd.to_numeric(df_mis[qty_col], errors="coerce").fillna(0)
            df_mis["Nhóm"] = df_mis[part_col].astype(str).map(map_code_to_type).fillna("")

            mis_groups_rules = {
                "Dây đai": {"related": ["Dây đai"], "qty_factors": {"Dây đai": 1}},
                "Lọc gió": {"related": ["Lọc gió"], "qty_factors": {"Lọc gió": 1}},
                "Lốp": {"related": ["Lốp"], "qty_factors": {"Lốp": 1}},
                "Má phanh": {
                    "related": ["Má phanh", "Má phanh x2", "Má phanh + Xích tải x3"],
                    "qty_factors": {"Má phanh": 1, "Má phanh x2": 2, "Má phanh + Xích tải x3": 1}
                },
                "Xích tải": {
                    "related": ["Xích tải", "Má phanh + Xích tải x3"],
                    "qty_factors": {"Xích tải": 1, "Má phanh + Xích tải x3": 3}
                },
            }

            for g in groups:
                if g not in mis_groups_rules:
                    continue

                rule = mis_groups_rules[g]

                # --- Tồn SL: nhân hệ số ---
                total_qty = 0
                for subgroup, factor in rule["qty_factors"].items():
                    total_qty += df_mis.loc[df_mis["Nhóm"] == subgroup, qty_col].sum() * factor
                accum[g]["Stock_qty"] = total_qty

                # --- Tồn DNP: không nhân hệ số ---
                mask = df_mis["Nhóm"].isin(rule["related"])
                accum[g]["Stock_dnp"] = (df_mis.loc[mask, qty_col] *
                                        df_mis.loc[mask, part_col].map(map_code_to_dnp).fillna(0)).sum()




    # --- Tổng hợp kết quả ra DataFrame ---
    rows = []
    total_ban_dnp = total_nhan_dnp = total_stock_dnp = 0.0
    for g in groups:
        jc_q = accum[g]["JC_qty"]
        otc_q = accum[g]["OTC_qty"]
        jcotc_q = jc_q + otc_q
        ban_dnp = accum[g]["JC_dnp"] + accum[g]["OTC_dnp"]
        rec_q = accum[g]["Receive_qty"]
        rec_dnp = accum[g]["Receive_dnp"]
        stock_q = accum[g]["Stock_qty"]
        stock_dnp = accum[g]["Stock_dnp"]

        total_ban_dnp += ban_dnp
        total_nhan_dnp += rec_dnp
        total_stock_dnp += stock_dnp

        ratio = (jcotc_q / tong_xe * 100) if tong_xe else 0

        rows.append({
            "Nhóm": g,
            "JC": int(jc_q) if float(jc_q).is_integer() else round(jc_q, 2),
            "OTC": int(otc_q) if float(otc_q).is_integer() else round(otc_q, 2),
            "JC+OTC": int(jcotc_q) if float(jcotc_q).is_integer() else round(jcotc_q, 2),
            "Bán (DNP)": ban_dnp,
            "Nhận SL": int(rec_q) if float(rec_q).is_integer() else round(rec_q, 2),
            "Nhận (DNP)": rec_dnp,
            "Tỉ lệ / tổng xe": f"{ratio:.1f}%",  # tỷ lệ bán
            "Tỉ lệ nhận / bán": "",              # chỉ điền ở hàng tổng
            "Tồn SL": int(stock_q) if float(stock_q).is_integer() else round(stock_q, 2),
            "Tồn DNP": stock_dnp
        })

    # --- Hàng Tổng tiền ---
    ratio_nhan_ban = (total_nhan_dnp / total_ban_dnp * 100) if total_ban_dnp else 0
    rows.append({
        "Nhóm": "Tổng tiền",
        "JC": "",
        "OTC": "",
        "JC+OTC": "",
        "Bán (DNP)": total_ban_dnp,
        "Nhận SL": "",
        "Nhận (DNP)": total_nhan_dnp,
        "Tỉ lệ / tổng xe": "",
        "Tỉ lệ nhận / bán": f"{ratio_nhan_ban:.1f}%",
        "Tồn SL": "",
        "Tồn DNP": total_stock_dnp
    })


    df_out = pd.DataFrame(rows)

    # --- Format tiền theo VN ---
    def format_vn_number(v):
        if pd.isna(v) or v == "":
            return ""
        try:
            n = float(v)
            if n.is_integer():
                return f"{int(n):,}".replace(",", ".")
            else:
                return f"{n:,.2f}".replace(",", "X").replace(".", ",").replace("X", ".")
        except:
            return v

    money_cols = ["Bán (DNP)", "JC+OTC", "Nhận (DNP)", "Tồn DNP"]
    for col in money_cols:
        if col in df_out.columns:
            df_out[col] = df_out[col].apply(format_vn_number)

    import streamlit as st
    st.dataframe(df_out, hide_index=True, use_container_width=True)

    elapsed = time.time() - start_time
    log_messages.append(f"✅ Hoàn tất tính toán phụ tùng hao mòn - elapsed: {elapsed:.2f}s")
    log_messages.append(f"📈 Tổng DNP bán: {total_ban_dnp:,.0f}, Tổng DNP nhận: {total_nhan_dnp:,.0f}, Tổng tồn DNP: {total_stock_dnp:,.0f}")

    return df_out

def tinh_ton_kho(dataframes):
    import pandas as pd

    # --- chuẩn bị BPGRPM và CP (map mã->Phân loại, map mã->Nhóm hao_mòn) ---
    df_bp = dataframes.get("BPGRPM")
    if isinstance(df_bp, dict):
        # nếu dataframes["BPGRPM"] là dict chứa DataFrame, lấy first DF
        for v in df_bp.values():
            if isinstance(v, pd.DataFrame):
                df_bp = v.copy(); break
    elif isinstance(df_bp, pd.DataFrame):
        df_bp = df_bp.copy()
    else:
        df_bp = pd.DataFrame()

    if not df_bp.empty:
        df_bp.columns = [c.strip() for c in df_bp.columns]

    df_cp = dataframes.get("CP")
    if isinstance(df_cp, dict):
        for v in df_cp.values():
            if isinstance(v, pd.DataFrame):
                df_cp = v.copy(); break
    elif isinstance(df_cp, pd.DataFrame):
        df_cp = df_cp.copy()
    else:
        df_cp = pd.DataFrame()

    if not df_cp.empty:
        df_cp.columns = [c.strip() for c in df_cp.columns]

    # find cols
    code_col_bp = find_col(df_bp, ["Mã phụ tùng", "Mã Phụ tùng", "Part#", "Part Number"])
    phanloai_col_bp = find_col(df_bp, ["Phân loại", "Phân Loại", "Type", "Category"])
    dnp_col_bp = find_col(df_bp, ["DNP", "DNP ", "DNP/Unit Price", "Giá nhập", "DNP/Unit"])

    cp_code_col = find_col(df_cp, ["Mã Phụ tùng", "Mã phụ tùng", "Part#", "Part Number", "Part"])
    cp_type_col = find_col(df_cp, ["Loại phụ tùng", "Loại", "Type", "Loại phụ"])

    # map code -> Phân loại (BP/GR/PM) from BPGRPM
    map_code_to_cat = {}
    if code_col_bp and phanloai_col_bp and not df_bp.empty:
        df_bp[code_col_bp] = df_bp[code_col_bp].astype(str).str.strip()
        df_bp[phanloai_col_bp] = df_bp[phanloai_col_bp].astype(str).str.strip()
        map_code_to_cat = pd.Series(df_bp[phanloai_col_bp].values, index=df_bp[code_col_bp]).to_dict()

    # map code -> nhóm hao mòn (Dây đai, Lọc gió, Lốp, Má phanh, Xích tải) from CP
    # --- map code -> nhóm CP (chuẩn hoá) ---
    map_code_to_type = {}
    if cp_code_col and cp_type_col and not df_cp.empty:
        df_cp[cp_code_col] = df_cp[cp_code_col].astype(str).str.strip()
        # chuẩn hoá text nhóm, loại bỏ khoảng trắng dư, viết thường để so sánh
        df_cp["_type_norm"] = df_cp[cp_type_col].astype(str).str.strip()
        df_cp["_type_norm_low"] = df_cp["_type_norm"].str.lower()
        map_code_to_type = pd.Series(df_cp["_type_norm"].values, index=df_cp[cp_code_col]).to_dict()
        # thêm map chuẩn hoá lowercase để so sánh nhanh nếu cần
        map_code_to_type_lower = pd.Series(df_cp["_type_norm_low"].values, index=df_cp[cp_code_col]).to_dict()
    else:
        map_code_to_type_lower = {}


    # map code -> unit DNP from BPGRPM (dùng cho MIS khi MIS không có giá)
    map_code_to_dnp = {}
    if code_col_bp and dnp_col_bp and not df_bp.empty:
        tmp = df_bp[[code_col_bp, dnp_col_bp]].dropna(subset=[code_col_bp])
        tmp[code_col_bp] = tmp[code_col_bp].astype(str).str.strip()
        tmp["_dnp_num"] = tmp[dnp_col_bp].apply(parse_amount)
        map_code_to_dnp = pd.Series(tmp["_dnp_num"].values, index=tmp[code_col_bp]).to_dict()

    # --- helper: tính DNP theo mã cho file HPMJC/HPMOTC/Receive ---
    def sum_dnp_from_df(df, code_col, qty_col, price_col, status_col_name=None, status_closed_val="CLOSED"):
        out = {}
        if df is None or df.empty or code_col is None:
            return out
        df2 = df.copy()
        df2.columns = [c.strip() for c in df2.columns]
        # lọc trạng thái closed nếu có
        if status_col_name and status_col_name in df2.columns:
            df2 = df2[df2[status_col_name].astype(str).str.upper() == status_closed_val]
        # chuẩn hoá
        df2[code_col] = df2[code_col].astype(str).str.strip()
        qty = 0
        if qty_col and qty_col in df2.columns:
            df2["_qty"] = pd.to_numeric(df2[qty_col], errors="coerce").fillna(0)
        else:
            df2["_qty"] = 0
        if price_col and price_col in df2.columns:
            try:
                df2["_price"] = df2[price_col].apply(parse_amount).fillna(0)
            except Exception:
                df2["_price"] = pd.to_numeric(df2[price_col], errors="coerce").fillna(0)
        else:
            df2["_price"] = 0
        df2["_dnp"] = df2["_qty"] * df2["_price"]
        grp = df2.groupby(code_col)["_dnp"].sum().to_dict()
        return grp

    # --- HPMJC ---
    df_jc = dataframes.get("HPMJC")
    jc_by_code = {}
    if isinstance(df_jc, pd.DataFrame):
        df_jc = df_jc.copy()
        df_jc.columns = [c.strip() for c in df_jc.columns]
        status_col_jc = find_col(df_jc, ["Trạng thái", "Status", "Trạng thái đặt hàng"])
        code_col_jc = find_col(df_jc, ["Mã phụ tùng", "Part#", "Part Number"])
        qty_col_jc = find_col(df_jc, ["Số lượng xác nhận", "Số lượng", "Confirmed Quantity"])
        price_col_jc = find_col(df_jc, ["Giá nhập", "Đơn giá", "Cost Price"])
        jc_by_code = sum_dnp_from_df(df_jc, code_col_jc, qty_col_jc, price_col_jc, status_col_jc, "CLOSED")

    # --- HPMOTC ---
    df_otc = dataframes.get("HPMOTC")
    otc_by_code = {}
    if isinstance(df_otc, pd.DataFrame):
        df_otc = df_otc.copy()
        df_otc.columns = [c.strip() for c in df_otc.columns]
        status_col_otc = find_col(df_otc, ["Trạng thái", "Trạng thái đặt hàng", "Status"])
        code_col_otc = find_col(df_otc, ["Mã phụ tùng", "Part#", "Part Number"])
        qty_col_otc = find_col(df_otc, ["Số lượng đặt hàng", "Số lượng", "Order Quantity"])
        price_col_otc = find_col(df_otc, ["Giá nhập", "Đơn giá", "Cost Price"])
        otc_by_code = sum_dnp_from_df(df_otc, code_col_otc, qty_col_otc, price_col_otc, status_col_otc, "CLOSED")

    # --- Receive ---
    df_rcv = dataframes.get("Receive")
    rcv_by_code = {}
    if isinstance(df_rcv, pd.DataFrame):
        df_rcv = df_rcv.copy()
        df_rcv.columns = [c.strip() for c in df_rcv.columns]
        status_col_rcv = find_col(df_rcv, ["MRN Status", "Status", "Trạng thái"])
        code_col_rcv = find_col(df_rcv, ["Part#", "Part Number", "Mã phụ tùng", "Part"])
        qty_col_rcv = find_col(df_rcv, ["Qty", "Quantity", "Số lượng"])
        price_col_rcv = find_col(df_rcv, ["DNP/Unit Price", "Unit Price", "Price", "Giá nhập"])
        rcv_by_code = sum_dnp_from_df(df_rcv, code_col_rcv, qty_col_rcv, price_col_rcv, status_col_rcv, "CLOSED")

    # --- MIS (tồn): MIS có Quantity + Part Number, không có giá -> dùng DNP từ BPGRPM ---
    mis_by_code = {}
    df_mis = dataframes.get("MIS")
    if isinstance(df_mis, pd.DataFrame):
        df_mis = df_mis.copy()
        df_mis.columns = [c.strip() for c in df_mis.columns]
        code_col_mis = find_col(df_mis, ["Part Number", "Part#", "Mã phụ tùng"])
        qty_col_mis = find_col(df_mis, ["Quantity", "Số lượng", "Qty"])
        price_col_mis = find_col(df_mis, ["Giá nhập", "Đơn giá", "Cost Price", "Unit Price"])
        if code_col_mis and qty_col_mis:
            df_mis[code_col_mis] = df_mis[code_col_mis].astype(str).str.strip()
            df_mis["_qty"] = pd.to_numeric(df_mis[qty_col_mis], errors="coerce").fillna(0)
            if price_col_mis and price_col_mis in df_mis.columns:
                # nếu có giá trong MIS (hiếm), dùng để tính
                try:
                    df_mis["_price"] = df_mis[price_col_mis].apply(parse_amount).fillna(0)
                except Exception:
                    df_mis["_price"] = pd.to_numeric(df_mis[price_col_mis], errors="coerce").fillna(0)
                df_mis["_dnp"] = df_mis["_qty"] * df_mis["_price"]
                mis_by_code = df_mis.groupby(code_col_mis)["_dnp"].sum().to_dict()
            else:
                # fallback: dùng map_code_to_dnp từ BPGRPM
                for _, r in df_mis[[code_col_mis, "_qty"]].iterrows():
                    code = str(r[code_col_mis]).strip()
                    q = float(r["_qty"])
                    unit = map_code_to_dnp.get(code, 0)
                    if unit:
                        mis_by_code[code] = mis_by_code.get(code, 0) + q * unit

    # --- Aggregate: theo Phân loại (BP/GR/PM) và theo 5 món hao mòn (dựa trên CP map) ---
    hao_mon_list = ["Dây đai", "Lọc gió", "Lốp", "Má phanh", "Xích tải"]
    # initialize counters
    jc_cat = {"BP":0.0, "GR":0.0, "PM":0.0, "OIL":0.0}
    otc_cat = {"BP":0.0, "GR":0.0, "PM":0.0, "OIL":0.0}
    rcv_cat = {"BP":0.0, "GR":0.0, "PM":0.0, "OIL":0.0}
    mis_cat = {"BP":0.0, "GR":0.0, "PM":0.0, "OIL":0.0}
    # haomon sums (DNP)
    jc_haomon = 0.0; otc_haomon = 0.0; rcv_haomon = 0.0; mis_haomon = 0.0

    # --- helper: xác định có thuộc nhóm 5 món hao mòn không ---
    def is_code_haomon(code):
        """
        Trả True nếu mã phụ tùng thuộc 5 món hao mòn:
        Dây đai, Lọc gió, Lốp, Má phanh, Xích tải
        Bao gồm các variant như 'Má phanh x2', 'Má phanh + Xích tải x3'
        """
        c = str(code).strip()
        # 1️⃣ Kiểm tra trong CP map
        t_low = map_code_to_type_lower.get(c, "")
        if t_low:
            for base in ["dây đai", "lọc gió", "lốp", "má phanh", "xích tải"]:
                if base in t_low:
                    return True

        # 2️⃣ Nếu không có CP map, fallback sang category map
        cat = map_code_to_cat.get(c, "")
        if isinstance(cat, str) and cat.strip() != "":
            cat_low = cat.lower()
            for base in ["dây đai", "lọc gió", "lốp", "má phanh", "xích tải"]:
                if base in cat_low:
                    return True

        return False

    # --- helper để cộng giá trị vào nhóm và tổng hợp 5 món ---
    def add_code_val(code, val, target_cat_dict, haomon_acc):
        """
        Cộng giá trị vào nhóm tương ứng trong target_cat_dict
        và nếu thuộc 5 món hao mòn thì cộng thêm vào biến haomon_acc
        """
        c = str(code).strip()
        cat = map_code_to_cat.get(c, "")
        if cat in target_cat_dict:
            target_cat_dict[cat] += val

        # Nếu mã này thuộc nhóm 5 món hao mòn (gồm cả variant)
        if is_code_haomon(c):
            return val  # giá trị này sẽ được cộng thêm vào tổng haomon
        return 0.0

    # aggregate JC
    for code, val in jc_by_code.items():
        added_ha = add_code_val(code, val, jc_cat, jc_haomon)
        jc_haomon += added_ha
    # aggregate OTC
    for code, val in otc_by_code.items():
        added_ha = add_code_val(code, val, otc_cat, otc_haomon)
        otc_haomon += added_ha
    # aggregate Receive
    for code, val in rcv_by_code.items():
        added_ha = add_code_val(code, val, rcv_cat, rcv_haomon)
        rcv_haomon += added_ha
    # aggregate MIS
    for code, val in mis_by_code.items():
        added_ha = add_code_val(code, val, mis_cat, mis_haomon)
        mis_haomon += added_ha

    # --- Build rows ---
    rows = []
    for cat in ["BP", "GR", "OIL"]:
        jc_v = jc_cat.get(cat, 0.0)
        otc_v = otc_cat.get(cat, 0.0)
        ban = jc_v + otc_v
        nhan = rcv_cat.get(cat, 0.0)
        ton = mis_cat.get(cat, 0.0)
        rows.append({
            "Nhóm": cat,
            "JC": jc_v,
            "OTC": otc_v,
            "Bán (JC+OTC)": ban,
            "Nhận": nhan,
            "Tồn kho": ton
        })


    # 5 món hao mòn row (DNP sums)
    rows.append({"Nhóm": "5 món hao mòn", "JC": jc_haomon, "OTC": otc_haomon,
                 "Bán (JC+OTC)": jc_haomon + otc_haomon, "Nhận": rcv_haomon, "Tồn kho": mis_haomon})

    # PM row = PM_total - 5mon
    pm_total_jc = jc_cat.get("PM", 0.0)
    pm_total_otc = otc_cat.get("PM", 0.0)
    pm_total_rcv = rcv_cat.get("PM", 0.0)
    pm_total_mis = mis_cat.get("PM", 0.0)

    pm_jc = pm_total_jc - jc_haomon
    pm_otc = pm_total_otc - otc_haomon
    pm_rcv = pm_total_rcv - rcv_haomon
    pm_mis = pm_total_mis - mis_haomon

    rows.append({"Nhóm": "PM", "JC": pm_jc, "OTC": pm_otc, "Bán (JC+OTC)": pm_jc + pm_otc, "Nhận": pm_rcv, "Tồn kho": pm_mis})

    # Tổng
    total = {"Nhóm": "Tổng"}
    for k in ["JC", "OTC", "Bán (JC+OTC)", "Nhận", "Tồn kho"]:
        total[k] = sum(r[k] for r in rows)
    rows.append(total)

    df_tonkho = pd.DataFrame(rows)
    return df_tonkho






# === Phần tính toán HCR (nếu có file HCR) ===
if "HCR" in dataframes:
    df = dataframes["HCR"]

    required_cols = ["Job Card #", "Job Card Status", "Service Type", "Final Labour Amount"]
    missing = [c for c in required_cols if c not in df.columns]

    if missing:
        st.error(f"⚠️ Thiếu cột trong file HCR: {', '.join(missing)}")
    else:
        # Lọc phiếu Closed
        df_closed = df[df["Job Card Status"].astype(str).str.lower() == "closed"].copy()

        # Tổng lượt xe
        tong_xe = len(df_closed)

        # Tiền công sửa chữa
        df_closed["Tiền công sửa chữa"] = df_closed["Final Labour Amount"].apply(parse_amount)
        tong_suachua = df_closed["Tiền công sửa chữa"].sum()

        # Tính KTĐK
        ktdk_counts = {}
        ktdk_values = {}
        for service, cost in ktdk_cost.items():
            count = len(df_closed[df_closed["Service Type"] == service])
            ktdk_counts[service] = count
            ktdk_values[service] = count * cost

        tong_ktdk = sum(ktdk_values.values())

        # --- Phần mới: Tính "Xe thay dầu" ---
        dau_count = 0
        dau_ktdk_counts = {k: 0 for k in ktdk_cost.keys()}
        dau_suachua = 0
        if "HPMJC" in dataframes:
            df_hpmjc = dataframes["HPMJC"]
            # nếu là dict of sheets, convert to df (lấy first sheet)
            if isinstance(df_hpmjc, dict):
                df_hpmjc = df_hpmjc.get("BPGRPM") or list(df_hpmjc.values())[0]
            cols = [c.strip() for c in df_hpmjc.columns]
            df_hpmjc.columns = cols  # Xóa khoảng trắng đầu/cuối cột

            # 👉 Chỉ lấy những phiếu có Trạng thái = "Closed"
            if "Trạng thái" in df_hpmjc.columns:
                df_hpmjc = df_hpmjc[df_hpmjc["Trạng thái"].astype(str).str.upper() == "CLOSED"]

            if "Tên phụ tùng" in df_hpmjc.columns and "Đơn hàng dịch vu" in df_hpmjc.columns:
                dau_rows = df_hpmjc["Tên phụ tùng"].astype(str)

                # Tìm các dòng có Dầu hoặc Chai dầu ở đầu
                mask_dau = (
                    dau_rows.str.upper().str.startswith("DẦU") |
                    dau_rows.str.upper().str.startswith("CHAI DẦU")
                )

                # Loại bỏ “Chai dầu hộp số”
                mask_loai_bo = dau_rows.str.upper().str.startswith("CHAI DẦU HỘP SỐ")

                # Giữ lại chỉ những dòng thỏa điều kiện
                dau_rows = df_hpmjc[mask_dau & ~mask_loai_bo]

                # Danh sách đơn hàng dịch vụ duy nhất
                dau_jobs = dau_rows["Đơn hàng dịch vu"].dropna().unique().tolist()
                dau_count = len(dau_jobs)

                # Ghép qua HCR để xác định loại dịch vụ
                df_map = df_closed[["Job Card #", "Service Type"]].copy()
                df_map.columns = ["Đơn hàng dịch vu", "Service Type"]
                dau_merge = pd.merge(
                    pd.DataFrame({"Đơn hàng dịch vu": dau_jobs}),
                    df_map,
                    on="Đơn hàng dịch vu",
                    how="left"
                )

                # Tính theo Service Type (KTĐK hoặc sửa chữa)
                dau_ktdk_counts = {k: 0 for k in ktdk_cost.keys()}
                dau_suachua = 0
                for _, row in dau_merge.iterrows():
                    svc = row["Service Type"]
                    if svc in dau_ktdk_counts:
                        dau_ktdk_counts[svc] += 1
                    else:
                        dau_suachua += 1
            else:
                st.warning("⚠️ File HPMJC thiếu cột 'Tên phụ tùng' hoặc 'Đơn hàng dịch vu'.")
        else:
            st.info("ℹ️ Không có file HPMJC, bỏ qua phần xe thay dầu.")


        # --- Tính tổng cộng ---
        tong_cong = tong_suachua + tong_ktdk

        # --- Gộp bảng “Số lượt xe” + “Công thợ” + “Xe thay dầu” ---
        data = {
            "Chỉ tiêu": ["Lượt xe", "Công thợ", "Xe thay dầu"],
            "Sửa chữa": [
                tong_xe - sum(ktdk_counts.values()),
                tong_suachua,
                dau_suachua,
            ],
            "KTĐK lần 1": [
                ktdk_counts["PI Service 01"],
                ktdk_values["PI Service 01"],
                dau_ktdk_counts["PI Service 01"],
            ],
            "KTĐK lần 2": [
                ktdk_counts["PI Service 02"],
                ktdk_values["PI Service 02"],
                dau_ktdk_counts["PI Service 02"],
            ],
            "KTĐK lần 3": [
                ktdk_counts["PI Service 03"],
                ktdk_values["PI Service 03"],
                dau_ktdk_counts["PI Service 03"],
            ],
            "KTĐK lần 4": [
                ktdk_counts["PI Service 04"],
                ktdk_values["PI Service 04"],
                dau_ktdk_counts["PI Service 04"],
            ],
            "KTĐK lần 5": [
                ktdk_counts["PI Service 05"],
                ktdk_values["PI Service 05"],
                dau_ktdk_counts["PI Service 05"],
            ],
            "KTĐK lần 6": [
                ktdk_counts["PI Service 06"],
                ktdk_values["PI Service 06"],
                dau_ktdk_counts["PI Service 06"],
            ],
            "Tổng": [
                tong_xe,
                tong_cong,
                dau_count,
            ],
        }

        result_df = pd.DataFrame(data).set_index("Chỉ tiêu")

        # --- Thêm cột Tổng PI, Tỉ lệ xe thay dầu, Tỉ lệ xe thay dầu PI ---
        result_df = result_df.copy()

        # Lấy tất cả các cột KTĐK lần 1 → lần 6
        ktdk_cols = [c for c in result_df.columns if "KTĐK lần" in c]

        # Nếu tìm thấy thì cộng lại
        if ktdk_cols:
            result_df["Tổng PI"] = result_df[ktdk_cols].sum(axis=1)
        else:
            result_df["Tổng PI"] = 0

        # 2️⃣ Tính Tỉ lệ xe thay dầu = Tổng xe thay dầu / Tổng lượt xe
        if "Xe thay dầu" in result_df.index and "Lượt xe" in result_df.index:
            total_xe = result_df.loc["Lượt xe", "Tổng"]
            total_dau = result_df.loc["Xe thay dầu", "Tổng"]
            result_df.loc["Tỉ lệ xe thay dầu", :] = ""
            result_df.loc["Tỉ lệ xe thay dầu", "Tổng"] = (
                f"{(total_dau / total_xe * 100):.1f}%" if total_xe else "0%"
            )
        else:
            st.warning("⚠️ Không tìm thấy dòng 'Xe thay dầu' hoặc 'Lượt xe' trong bảng.")

        # 3️⃣ Tính Tỉ lệ xe thay dầu PI = Tổng xe thay dầu PI / Tổng lượt xe PI (KTĐK)
        if "Xe thay dầu" in result_df.index and "Lượt xe" in result_df.index:
            dau_pi = result_df.loc["Xe thay dầu", ktdk_cols].sum()
            xe_pi = result_df.loc["Lượt xe", ktdk_cols].sum()
            result_df.loc["Tỉ lệ xe thay dầu PI", :] = ""
            result_df.loc["Tỉ lệ xe thay dầu PI", "Tổng PI"] = (
                f"{(dau_pi / xe_pi * 100):.1f}%" if xe_pi else "0%"
            )

        # Đưa cột Tổng PI lên trước cột Tổng
        cols = list(result_df.columns)
        if "Tổng" in cols and "Tổng PI" in cols:
            cols.insert(cols.index("Tổng"), cols.pop(cols.index("Tổng PI")))
            result_df = result_df[cols]

        # --- Format tiền và hiển thị ---
        def format_vn_number(v):
            if pd.isna(v) or v == "":
                return ""
            try:
                n = float(v)
                if n.is_integer():
                    return f"{int(n):,}".replace(",", ".")
                else:
                    return f"{n:,.2f}".replace(",", "X").replace(".", ",").replace("X", ".")
            except:
                return v

        fmt_df = result_df.copy()

        # ✅ Áp dụng format cho toàn bộ bảng
        fmt_df = fmt_df.applymap(format_vn_number)

        # ✅ Hiển thị kết quả
        st.subheader("📋 Lượt xe")
        st.dataframe(fmt_df, use_container_width=True)





        # --- PHẦN MỚI: BẢNG TỔNG HỢP DOANH THU PT - DẦU ---
        # (Đặt ngoài block if để chạy khi có file tương ứng)
        # --- Vì tong_xe có ở đây nên ta giữ phần doanh thu sau ---
        if "HPMJC" in dataframes or "HPMOTC" in dataframes or "Receive" in dataframes:
            st.subheader("💰 Doanh thu PT - Dầu")

            # === HPM JC ===
            dt_pt_dau_jc = dt_dau_jc = 0
            if "HPMJC" in dataframes:
                df_jc = dataframes["HPMJC"].copy()
                # nếu dict -> lấy first sheet
                if isinstance(df_jc, dict):
                    df_jc = list(df_jc.values())[0]
                df_jc.columns = [c.strip() for c in df_jc.columns]

                if "Trạng thái" in df_jc.columns and "Giá nhập" in df_jc.columns and "Số lượng xác nhận" in df_jc.columns:
                    df_jc = df_jc[df_jc["Trạng thái"].astype(str).str.upper() == "CLOSED"]
                    df_jc["Giá nhập"] = df_jc["Giá nhập"].apply(parse_amount)
                    df_jc["Số lượng xác nhận"] = pd.to_numeric(df_jc["Số lượng xác nhận"], errors="coerce").fillna(0)
                    df_jc["Thành tiền"] = df_jc["Giá nhập"] * df_jc["Số lượng xác nhận"]

                    dt_pt_dau_jc = df_jc["Thành tiền"].sum()

                    # Doanh thu dầu (Tên phụ tùng bắt đầu bằng "Dầu" hoặc "Chai dầu")
                    mask_dau = df_jc["Tên phụ tùng"].astype(str).str.upper().str.startswith(("DẦU", "CHAI DẦU"))
                    df_dau = df_jc[mask_dau]
                    dt_dau_jc = df_dau["Thành tiền"].sum()

            dt_pt_jc = dt_pt_dau_jc - dt_dau_jc


            # === HPM OTC ===
            dt_pt_dau_otc = dt_dau_otc = 0
            if "HPMOTC" in dataframes:
                df_otc = dataframes["HPMOTC"].copy()
                if isinstance(df_otc, dict):
                    df_otc = list(df_otc.values())[0]
                df_otc.columns = [c.strip() for c in df_otc.columns]

                if "Trạng thái đặt hàng" in df_otc.columns and "Giá nhập" in df_otc.columns and "Số lượng đặt hàng" in df_otc.columns:
                    df_otc = df_otc[df_otc["Trạng thái đặt hàng"].astype(str).str.upper() == "CLOSED"]
                    df_otc["Giá nhập"] = df_otc["Giá nhập"].apply(parse_amount)
                    df_otc["Số lượng đặt hàng"] = pd.to_numeric(df_otc["Số lượng đặt hàng"], errors="coerce").fillna(0)
                    df_otc["Thành tiền"] = df_otc["Giá nhập"] * df_otc["Số lượng đặt hàng"]

                    dt_pt_dau_otc = df_otc["Thành tiền"].sum()

                    # Tên phụ tùng dầu tham chiếu qua file JC (nếu có)
                    dau_codes = []
                    if "HPMJC" in dataframes:
                        df_jc_lookup = dataframes["HPMJC"]
                        if isinstance(df_jc_lookup, dict):
                            df_jc_lookup = list(df_jc_lookup.values())[0]
                        if "Tên phụ tùng" in df_jc_lookup.columns and "Mã phụ tùng" in df_jc_lookup.columns:
                            dau_rows = df_jc_lookup
                            dau_rows = dau_rows[
                                dau_rows["Tên phụ tùng"].astype(str).str.upper().str.startswith(("DẦU", "CHAI DẦU"))
                            ]
                            dau_codes = dau_rows["Mã phụ tùng"].dropna().astype(str).unique().tolist()

                    if dau_codes and "Mã phụ tùng" in df_otc.columns:
                        mask_dau_otc = df_otc["Mã phụ tùng"].astype(str).isin(dau_codes)
                        dt_dau_otc = df_otc.loc[mask_dau_otc, "Thành tiền"].sum()

            dt_pt_otc = dt_pt_dau_otc - dt_dau_otc


            # === RECEIVE ===
            dt_pt_dau_receive = dt_dau_receive = 0
            if "Receive" in dataframes:
                df_rcv = dataframes["Receive"].copy()
                if isinstance(df_rcv, dict):
                    df_rcv = list(df_rcv.values())[0]
                df_rcv.columns = [c.strip() for c in df_rcv.columns]

                if "Qty" in df_rcv.columns and "DNP/Unit Price" in df_rcv.columns:
                    df_rcv["Qty"] = pd.to_numeric(df_rcv["Qty"], errors="coerce").fillna(0)
                    df_rcv["DNP/Unit Price"] = df_rcv["DNP/Unit Price"].astype(str).str.replace("₫", "", regex=False)
                    df_rcv["DNP/Unit Price"] = df_rcv["DNP/Unit Price"].str.replace(",", "").str.strip()
                    df_rcv["DNP/Unit Price"] = pd.to_numeric(df_rcv["DNP/Unit Price"], errors="coerce").fillna(0)
                    df_rcv["Thành tiền"] = df_rcv["Qty"] * df_rcv["DNP/Unit Price"]
                    dt_pt_dau_receive = df_rcv["Thành tiền"].sum()

                    # Lọc Dầu*
                    if "Description" in df_rcv.columns:
                        mask_dau_rcv = df_rcv["Description"].astype(str).str.upper().str.startswith(("DẦU", "CHAI DẦU", "PHUY DẦU", "THÙNG DẦU"))
                        dt_dau_receive = df_rcv.loc[mask_dau_rcv, "Thành tiền"].sum()

            dt_pt_receive = dt_pt_dau_receive - dt_dau_receive


            # === TỔNG HỢP ===
            dt_pt_jcotc = dt_pt_jc + dt_pt_otc
            dt_dau_jcotc = dt_dau_jc + dt_dau_otc
            dt_pt_dau_jcotc = dt_pt_dau_jc + dt_pt_dau_otc
            tile_nhanban = dt_pt_dau_receive / dt_pt_dau_jcotc if dt_pt_dau_jcotc else 0

            # === Tạo bảng doanh thu PT - Dầu ===
            table_data = {
                "": ["JC", "OTC", "JC + OTC", "Nhận"],
                "Doanh thu PT": [dt_pt_jc, dt_pt_otc, dt_pt_jcotc, dt_pt_receive],
                "Doanh thu dầu": [dt_dau_jc, dt_dau_otc, dt_dau_jcotc, dt_dau_receive],
                "Doanh thu PT + dầu": [dt_pt_dau_jc, dt_pt_dau_otc, dt_pt_dau_jcotc, dt_pt_dau_receive],
                "DT JC dầu / xe": [dt_dau_jc / tong_xe if tong_xe else 0, None, None, None],
                "DT JC / xe": [dt_pt_dau_jc / tong_xe if tong_xe else 0, None, None, None],
                "Tỉ lệ Nhận/Bán": [None, None, f"{tile_nhanban*100:.1f}%", None],
            }

            df_summary = pd.DataFrame(table_data)

            # 🎯 Hàm format chuẩn Việt Nam (làm tròn bỏ phần thập phân)
            def format_vn_number(v):
                if pd.isna(v) or v == "":
                    return ""
                try:
                    n = float(v)
                    return f"{int(round(n)):,}".replace(",", ".")
                except:
                    return v

            # 🎯 Format hiển thị tiền (chuẩn Việt Nam)
            money_cols = ["Doanh thu PT", "Doanh thu dầu", "Doanh thu PT + dầu", "DT JC dầu / xe", "DT JC / xe"]
            for col in money_cols:
                if col in df_summary.columns:
                    df_summary[col] = df_summary[col].apply(format_vn_number)

            # 🧾 Hiển thị bảng
            st.dataframe(df_summary, hide_index=True, use_container_width=True)




        # --- BỔ SUNG: Tổng hợp phụ tùng hao mòn ---
        st.subheader("🔧 Phụ tùng hao mòn")

        # Gọi hàm tính toán và nhận cả log
        df_hao_mon = tinh_phu_tung_hao_mon(dataframes, tong_xe)

        # Hiển thị bảng kết quả
        #st.dataframe(df_hao_mon, width='stretch')

        # Hiển thị nhật ký xử lý chi tiết
        #st.text_area("📋 Nhật ký xử lý", log_text, height=250)

        # --- Cho phép tải file Excel ---
        buffer = io.BytesIO()
        with pd.ExcelWriter(buffer, engine="openpyxl") as writer:
            df_hao_mon.to_excel(writer, sheet_name="Tổng hợp phụ tùng hao mòn", index=False)
        buffer.seek(0)

        #st.download_button(
        #    "⬇️ Tải bảng Phụ tùng hao mòn (.xlsx)",
        #    data=buffer,
        #    file_name="Phutung_hao_mon.xlsx",
        #    mime="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        #)

        # --- Gọi hàm tính tồn kho ---
        df_tonkho = tinh_ton_kho(dataframes)
        st.subheader("📦 Tổng hợp Bán - Nhận - Tồn kho")
        st.dataframe(
            df_tonkho.style.format("{:,.0f}", subset=["JC","OTC","Bán (JC+OTC)","Nhận","Tồn kho"]),
            hide_index=True
        )


        # Lưu lại nếu cần export thêm sau này
        dataframes["Tonkho_summary"] = df_tonkho


else:
    st.info("👉 Vui lòng tải file lên để xem báo cáo.")




